{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\91900\\\\Twitter-clone\\\\Twitter-clone-project\\\\client\\\\src\\\\components\\\\EditProfile\\\\EditProfile.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"../../redux/axiosconfig\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { changeProfile, logout } from \"../../redux/userSlice\";\nimport { useNavigate } from \"react-router-dom\";\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport app from \"../../firebase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfile = _ref => {\n  _s();\n  let {\n    setOpen\n  } = _ref;\n  const {\n    currentUser\n  } = useSelector(state => state.user);\n  const [img, setImg] = useState(null);\n  const [imgUploadProgress, setImgUploadProgress] = useState(0);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const uploadImg = file => {\n    const storage = getStorage(app);\n    const fileName = new Date().getTime() + file.name;\n    const storageRef = ref(storage, fileName);\n    const uploadTask = uploadBytesResumable(storageRef, file);\n\n    // Listen for state changes, errors, and completion of the upload.\n    uploadTask.on(\"state_changed\", snapshot => {\n      // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\n      const progress = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n      setImgUploadProgress(Math.round(progress));\n      switch (snapshot.state) {\n        case \"paused\":\n          console.log(\"Upload is paused\");\n          break;\n        case \"running\":\n          console.log(\"Upload is running\");\n          break;\n        default:\n          break;\n      }\n    }, error => {}, () => {\n      // Upload completed successfully, now we can get the download URL\n      getDownloadURL(uploadTask.snapshot.ref).then(async downloadURL => {\n        try {\n          const updateProfile = await axios.put(`/users/${currentUser._id}`, {\n            profilePicture: downloadURL\n          });\n          console.log(updateProfile);\n        } catch (error) {\n          console.log(error);\n        }\n        console.log(\"downloaded \" + downloadURL);\n        dispatch(changeProfile(downloadURL));\n      });\n    });\n  };\n  const handleDelete = async () => {\n    const deleteProfile = await axios.delete(`/users/${currentUser._id}`);\n    dispatch(logout());\n    navigate(\"/signin\");\n  };\n  useEffect(() => {\n    img && uploadImg(img);\n  }, [img]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"absolute w-full h-full top-0 left-0 bg-transparent flex items-center justify-center\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-[600px] h-[600px] bg-slate-200 rounded-lg p-8 flex flex-col gap-4 relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setOpen(false),\n        className: \"absolute top-3 right-3 cursor-pointer\",\n        children: \"X\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"font-bold text-xl\",\n        children: \"Edit Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Choose a new profile picture\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), imgUploadProgress > 0 ? \"Uploading \" + imgUploadProgress + \"%\" : /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        className: \"bg-transparent border border-slate-500 rounded p-2\",\n        accept: \"image/*\",\n        onChange: e => setImg(e.target.files[0])\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Delete Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"bg-red-500 text-white py-2 rounded-full\",\n        onClick: handleDelete,\n        children: \"Delete Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfile, \"PoCVYP0qcwiOk1VZzciiiQuqnH4=\", false, function () {\n  return [useSelector, useDispatch, useNavigate];\n});\n_c = EditProfile;\nexport default EditProfile;\nvar _c;\n$RefreshReg$(_c, \"EditProfile\");","map":{"version":3,"names":["React","useState","useEffect","axios","useDispatch","useSelector","changeProfile","logout","useNavigate","getStorage","ref","uploadBytesResumable","getDownloadURL","app","EditProfile","setOpen","currentUser","state","user","img","setImg","imgUploadProgress","setImgUploadProgress","dispatch","navigate","uploadImg","file","storage","fileName","Date","getTime","name","storageRef","uploadTask","on","snapshot","progress","bytesTransferred","totalBytes","Math","round","console","log","error","then","downloadURL","updateProfile","put","_id","profilePicture","handleDelete","deleteProfile","delete","e","target","files"],"sources":["C:/Users/91900/Twitter-clone/Twitter-clone-project/client/src/components/EditProfile/EditProfile.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"../../redux/axiosconfig\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport { changeProfile, logout } from \"../../redux/userSlice\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  getStorage,\r\n  ref,\r\n  uploadBytesResumable,\r\n  getDownloadURL,\r\n} from \"firebase/storage\";\r\n\r\nimport app from \"../../firebase\";\r\n\r\nconst EditProfile = ({ setOpen }) => {\r\n  const { currentUser } = useSelector((state) => state.user);\r\n\r\n  const [img, setImg] = useState(null);\r\n  const [imgUploadProgress, setImgUploadProgress] = useState(0);\r\n\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const uploadImg = (file) => {\r\n    const storage = getStorage(app);\r\n    const fileName = new Date().getTime() + file.name;\r\n    const storageRef = ref(storage, fileName);\r\n    const uploadTask = uploadBytesResumable(storageRef, file);\r\n\r\n    // Listen for state changes, errors, and completion of the upload.\r\n    uploadTask.on(\r\n      \"state_changed\",\r\n      (snapshot) => {\r\n        // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\r\n        const progress =\r\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n        setImgUploadProgress(Math.round(progress));\r\n        switch (snapshot.state) {\r\n          case \"paused\":\r\n            console.log(\"Upload is paused\");\r\n            break;\r\n          case \"running\":\r\n            console.log(\"Upload is running\");\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      },\r\n      (error) => {},\r\n      () => {\r\n        // Upload completed successfully, now we can get the download URL\r\n        getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\r\n          try {\r\n            const updateProfile = await axios.put(`/users/${currentUser._id}`, {\r\n              profilePicture: downloadURL,\r\n            });\r\n\r\n            console.log(updateProfile);\r\n          } catch (error) {\r\n            console.log(error);\r\n          }\r\n\r\n          console.log(\"downloaded \" + downloadURL);\r\n          dispatch(changeProfile(downloadURL));\r\n        });\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    const deleteProfile = await axios.delete(`/users/${currentUser._id}`);\r\n    dispatch(logout());\r\n    navigate(\"/signin\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    img && uploadImg(img);\r\n  }, [img]);\r\n\r\n  return (\r\n    <div className=\"absolute w-full h-full top-0 left-0 bg-transparent flex items-center justify-center\">\r\n      <div className=\"w-[600px] h-[600px] bg-slate-200 rounded-lg p-8 flex flex-col gap-4 relative\">\r\n        <button\r\n          onClick={() => setOpen(false)}\r\n          className=\"absolute top-3 right-3 cursor-pointer\"\r\n        >\r\n          X\r\n        </button>\r\n        <h2 className=\"font-bold text-xl\">Edit Profile</h2>\r\n        <p>Choose a new profile picture</p>\r\n        {imgUploadProgress > 0 ? (\r\n          \"Uploading \" + imgUploadProgress + \"%\"\r\n        ) : (\r\n          <input\r\n            type=\"file\"\r\n            className=\"bg-transparent border border-slate-500 rounded p-2\"\r\n            accept=\"image/*\"\r\n            onChange={(e) => setImg(e.target.files[0])}\r\n          />\r\n        )}\r\n\r\n        <p>Delete Account</p>\r\n        <button\r\n          className=\"bg-red-500 text-white py-2 rounded-full\"\r\n          onClick={handleDelete}\r\n        >\r\n          Delete Account\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditProfile;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}